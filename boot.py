from machine import Pin, Timer, PWM
from neopixel import NeoPixel
import time

# pins
led_pin = Pin(5, Pin.OUT)
led = NeoPixel(led_pin, 1)
beeper_1 = PWM(Pin(15, Pin.OUT))
beeper_1.duty(0)
# beeper_2 = PWM(Pin(2, Pin.OUT))
# beeper_2.duty(0)


NOTE = {
    'C4': 262,
    'C#4': 278,
    'D4': 294,
    'D#4': 311,
    'E4': 330,
    'F4': 349,
    'F#4': 370,
    'G4': 392,
    'G#4': 415,
    'A4': 440,
    'A#4': 466,
    'B4': 494,
    'C5': 523,
    'C#5': 554,
    'D5': 587,
    'D#5': 622,
    'E5': 659,
    'F5': 698,
    'F#5': 740,
    'G5': 784,
    'G#5': 831,
    'A5': 880,
    'A#5': 932,
    'B5': 988,
    'C6': 1047,
}


def play(notes_list, tempo=120, volume=6):
    for note in notes_list:
        note_name, duration = note.split('-')
        if note_name == '0':
            beeper_1.duty(0)
            led[0] = (0, 0, 0)
            led.write()
        else:
            beeper_1.freq(NOTE[note_name])
            beeper_1.duty(volume)
            led[0] = (11, 0, 0)
            led.write()
        time.sleep(float(duration)*60/tempo*0.6)
        beeper_1.duty(0)
        led[0] = (0, 0, 0)
        led.write()
        time.sleep(float(duration)*60/tempo*0.4)


peppa_pig_theme = [
    'G5-1', 'E5-0.5', 'C5-0.5', 'D5-1', 'G4-1',
    'G4-0.5', 'B4-0.5', 'D5-0.5', 'F5-0.5', 'E5-1', 'C5-1',
    '0-4', '0-4',
    'G5-1', 'E5-0.5', 'C5-0.5', 'D5-1', 'G4-1',
    'G4-0.5', 'B4-0.5', 'D5-0.5', 'F5-0.5', 'E5-1', 'C5-1',
    '0-4', '0-4',
]

super_mario_theme = [
    'E5-0.5', 'E5-0.5', '0-0.5', 'E5-0.5', '0-0.5', 'C5-0.5', 'E5-1',
    'G5-1', '0-1', 'G4-1', '0-1',
    'C5-1', '0-0.5', 'G4-0.5', '0-1', 'E4-1',
    '0-0.5', 'A4-0.5', '0-0.5', 'B4-0.5', '0-0.5', 'A#4-0.5', 'A4-1',
    'G4-0.66', 'E5-0.67', 'G5-0.67', 'A5-1', 'F5-0.5', 'G5-0.5',
    '0-0.5', 'E5-0.5', '0-0.5', 'C5-0.5', 'D5-0.5', 'B4-0.5', '0-1',
    'C5-1', '0-0.5', 'G4-0.5', '0-1', 'E4-1',
    '0-0.5', 'A4-0.5', '0-0.5', 'B4-0.5', '0-0.5', 'A#4-0.5', 'A4-1',
    'G4-0.66', 'E5-0.67', 'G5-0.67', 'A5-1', 'F5-0.5', 'G5-0.5',
    '0-0.5', 'E5-0.5', '0-0.5', 'C5-0.5', 'D5-0.5', 'B4-0.5', '0-1',
    '0-1', 'G5-0.5', 'F#5-0.5', 'F5-0.5', 'D#5-0.5', '0-0.5', 'E5-0.5',
    '0-0.5', 'G#4-0.5', 'A4-0.5', 'C5-0.5', '0-0.5', 'A4-0.5', 'C5-0.5', 'D5-0.5',
    '0-1', 'G5-0.5', 'F#5-0.5', 'F5-0.5', 'D#5-0.5', '0-0.5', 'E5-0.5',
    '0-0.5', 'C6-0.5', '0-0.5', 'C6-0.5', 'C6-1', '0-1',
    '0-1', 'G5-0.5', 'F#5-0.5', 'F5-0.5', 'D#5-0.5', '0-0.5', 'E5-0.5',
    '0-0.5', 'G#4-0.5', 'A4-0.5', 'C5-0.5', '0-0.5', 'A4-0.5', 'C5-0.5', 'D5-0.5',
    '0-1', 'D#5-1', '0-0.5', 'D5-0.5', '0-1',
    'C5-3', '0-1',
    '0-1', 'G5-0.5', 'F#5-0.5', 'F5-0.5', 'D#5-0.5', '0-0.5', 'E5-0.5',
    '0-0.5', 'G#4-0.5', 'A4-0.5', 'C5-0.5', '0-0.5', 'A4-0.5', 'C5-0.5', 'D5-0.5',
    '0-1', 'G5-0.5', 'F#5-0.5', 'F5-0.5', 'D#5-0.5', '0-0.5', 'E5-0.5',
    '0-0.5', 'C6-0.5', '0-0.5', 'C6-0.5', 'C6-1', '0-1',
    '0-1', 'G5-0.5', 'F#5-0.5', 'F5-0.5', 'D#5-0.5', '0-0.5', 'E5-0.5',
    '0-0.5', 'G#4-0.5', 'A4-0.5', 'C5-0.5', '0-0.5', 'A4-0.5', 'C5-0.5', 'D5-0.5',
    '0-1', 'D#5-1', '0-0.5', 'D5-0.5', '0-1',
    'C5-3', '0-1',
    'C5-0.5', 'C5-0.5', '0-0.5', 'C5-0.5', '0-0.5', 'C5-0.5', 'D5-1',
    'E5-0.5', 'C5-0.5', '0-0.5', 'A4-0.5', 'G4-2',
    'C5-0.5', 'C5-0.5', '0-0.5', 'C5-0.5', '0-0.5', 'C5-0.5', 'D5-0.5', 'E5-0.5',
    '0-4',
    'C5-0.5', 'C5-0.5', '0-0.5', 'C5-0.5', '0-0.5', 'C5-0.5', 'D5-1',
    'E5-0.5', 'C5-0.5', '0-0.5', 'A4-0.5', 'G4-2',
]

while True:
    play(super_mario_theme, 200, 64)
